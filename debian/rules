#!/usr/bin/make -f

include /usr/share/dpkg/pkg-info.mk

export SETUPTOOLS_SCM_PRETEND_VERSION = $(DEB_VERSION_UPSTREAM)

%:
	dh $@ --buildsystem=pybuild --with python3

override_dh_auto_test:
	echo "skipping test because of missing cherrypy dependencies #970519"

execute_after_dh_auto_install:
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/controller/tests
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/core/tests
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/tests
	rm -f  debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/test.py
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/less/
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/js/bootstrap.min.js
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/js/jquery.min.js
