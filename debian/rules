#!/usr/bin/make -f

include /usr/share/dpkg/pkg-info.mk

export SETUPTOOLS_SCM_PRETEND_VERSION = $(DEB_VERSION_UPSTREAM)
export PYBUILD_BEFORE_TEST=python{version} setup.py develop

%:
	dh $@ --buildsystem=pybuild --test-tox

execute_after_dh_auto_install:
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/controller/tests
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/core/tests
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/tests
	rm -f  debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/test.py
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/bootstrap.*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/chart.*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/chartkick.*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/font-awesome.*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/fontawesome*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/FontAwesome*
	rm -rf debian/rdiffweb/usr/lib/python*/dist-packages/rdiffweb/static/*/jquery.*
